IF EXISTS(SELECT NAME FROM SYSOBJECTS WHERE NAME='FNK_FECHA_DDMMAA' AND XTYPE='FN')
BEGIN
   DROP FUNCTION FNK_FECHA_DDMMAA
END

GO
CREATE FUNCTION [dbo].FNK_FECHA_DDMMAA(@FECHA DATETIME)
RETURNS VARCHAR(10)
WITH ENCRYPTION
AS 
BEGIN 
   DECLARE @FECHA2 VARCHAR(10)
   SET @FECHA2=
   CASE WHEN DAY(@FECHA)<=9 THEN '0'+CAST(DAY(@FECHA)AS VARCHAR(2))
   ELSE CAST(DAY(@FECHA)AS VARCHAR(2)) END+'/'+
   CASE WHEN MONTH(@FECHA)<=9 THEN '0'+CAST(MONTH(@FECHA)AS VARCHAR(2))
   ELSE CAST(MONTH(@FECHA)AS VARCHAR(2)) END+'/'+
   CAST(YEAR(@FECHA)AS VARCHAR(4))
   RETURN @FECHA2
END


